<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>JavaScript.WebSockets</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_JavaScript-WebSockets.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ghcjs-websockets-0.2.0.0: GHCJS interface for the Javascript Websocket API</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>(c) Justin Le 2015</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>justin@jle.im</td></tr><tr><th>Stability</th><td>unstable</td></tr><tr><th>Portability</th><td>ghcjs</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">JavaScript.WebSockets</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Usage</a></li><li><a href="#g:2">Opening, closing, and working with connections</a></li><li><a href="#g:3">Sending data</a></li><li><a href="#g:4">Receiving data</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Contains functions and operations for working with Javascript Websocket
 connections, which are encapsulated in the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> object.</p><p>It includes operations for opening, closing, inspecting connections and
 operations for sending and receiving text and serializable data
 (instances of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>) through them.</p><p>Most of the necessary functionality is in hopefully in
 <a href="JavaScript-WebSockets.html">JavaScript.WebSockets</a>; more of the low-level API is exposed in
 <a href="JavaScript-WebSockets-Internal.html">JavaScript.WebSockets.Internal</a> if you need it for library
 construction.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Connection">Connection</a></li><li class="src short"><span class="keyword">class</span> <a href="#t:WSSendable">WSSendable</a> s</li><li class="src short"><span class="keyword">class</span> <a href="#t:WSReceivable">WSReceivable</a> s</li><li class="src short"><span class="keyword">data</span> <a href="#t:SocketMsg">SocketMsg</a><ul class="subs"><li>= <a href="#v:SocketMsgText">SocketMsgText</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></li><li>| <a href="#v:SocketMsgData">SocketMsgData</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/bytestring-0.10.6.0/html/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:ConnClosing">ConnClosing</a><ul class="subs"><li>= <a href="#v:ManualClose">ManualClose</a></li><li>| <a href="#v:JSClose">JSClose</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a>) (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Int.html#t:Int">Int</a>) (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a>)</li><li>| <a href="#v:OpenInterruptedClose">OpenInterruptedClose</a></li><li>| <a href="#v:UnexpectedClose">UnexpectedClose</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:ConnectionException">ConnectionException</a> = <a href="#v:ConnectionClosed">ConnectionClosed</a> {<ul class="subs"><li><a href="#v:_socketOrigin">_socketOrigin</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></li></ul>}</li><li class="src short"><a href="#v:withUrl">withUrl</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a> -&gt; (<a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a) -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a</li><li class="src short"><a href="#v:withUrlLeftovers">withUrlLeftovers</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a> -&gt; (<a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a) -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (a, [<a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a>])</li><li class="src short"><a href="#v:openConnection">openConnection</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="JavaScript-WebSockets.html#t:Connection">Connection</a></li><li class="src short"><a href="#v:closeConnection">closeConnection</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:closeConnectionLeftovers">closeConnectionLeftovers</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> [<a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a>]</li><li class="src short"><a href="#v:clearConnectionQueue">clearConnectionQueue</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:dumpConnectionQueue">dumpConnectionQueue</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> [<a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a>]</li><li class="src short"><a href="#v:connectionClosed">connectionClosed</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:connectionCloseReason">connectionCloseReason</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="JavaScript-WebSockets.html#t:ConnClosing">ConnClosing</a>)</li><li class="src short"><a href="#v:connectionOrigin">connectionOrigin</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></li><li class="src short"><a href="#v:sendData">sendData</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; a -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:sendData_">sendData_</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; a -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:sendText">sendText</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:sendText_">sendText_</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:sendMessage">sendMessage</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:sendMessage_">sendMessage_</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:send">send</a> :: <a href="JavaScript-WebSockets.html#t:WSSendable">WSSendable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; a -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:send_">send_</a> :: <a href="JavaScript-WebSockets.html#t:WSSendable">WSSendable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; a -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:receive">receive</a> :: <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a</li><li class="src short"><a href="#v:receiveMaybe">receiveMaybe</a> :: <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:receiveText">receiveText</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></li><li class="src short"><a href="#v:receiveTextMaybe">receiveTextMaybe</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a>)</li><li class="src short"><a href="#v:receiveData">receiveData</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a</li><li class="src short"><a href="#v:receiveDataMaybe">receiveDataMaybe</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:receiveMessage">receiveMessage</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></li><li class="src short"><a href="#v:receiveMessageMaybe">receiveMessageMaybe</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a>)</li><li class="src short"><a href="#v:receiveEither">receiveEither</a> :: <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Either.html#t:Either">Either</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a> a)</li><li class="src short"><a href="#v:receiveEitherMaybe">receiveEitherMaybe</a> :: <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Either.html#t:Either">Either</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a> a))</li></ul></div><div id="interface"><h1 id="g:1">Usage</h1><div class="doc"><pre>import Data.Text (unpack)

-- A simple echo client, echoing all incoming text data
main :: IO ()
main = withUrl &quot;ws://my-server.com&quot; $ \conn -&gt;
    forever $ do
        t &lt;- receiveText conn
        putStrLn (unpack t)
        sendText conn t</pre><p>The above code will attempt to interpret all incoming data as
 UTF8-encoded Text, and throw away data that does not.</p><p><code>conn</code> is a <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>, which encapsulates a websocket channel.</p><p>You can also do the same thing to interpret all incoming data as any
 instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code> --- say, <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Int.html#t:Int">Int</a></code>s:</p><pre>-- A simple client waiting for connections and outputting the running sum
main :: IO ()
main = withUrl &quot;ws://my-server.com&quot; (runningSum 0)

runningSum :: Int -&gt; Connection -&gt; IO ()
runningSum n conn = do
    i &lt;- receiveData conn
    print (n + i)
    runningSum (n + i) conn</pre><p><code><a href="JavaScript-WebSockets.html#v:receiveData">receiveData</a></code> will block until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives data that is
 decodable as whatever type you expect, and will throw away all
 nondecodable data (including <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> data).</p><p>The <code><a href="JavaScript-WebSockets.html#v:receive">receive</a></code> function is provided as a over-indulgent layer of
 abstraction where you can receive both <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> and instances of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>
 with the same function using typeclass magic --- for the examples above,
 you could use <code><a href="JavaScript-WebSockets.html#v:receive">receive</a></code> in place of both <code><a href="JavaScript-WebSockets.html#v:receiveText">receiveText</a></code> and
 <code><a href="JavaScript-WebSockets.html#v:receiveData">receiveData</a></code>.</p><p><code><a href="JavaScript-WebSockets.html#v:send">send</a></code> works the same way for <code><a href="JavaScript-WebSockets.html#v:sendText">sendText</a></code> and <code><a href="JavaScript-WebSockets.html#v:sendData">sendData</a></code>.</p><p>If you want to, you can access the incoming data directly using the
 <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code> sum type, which exposes either a <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> or a lazy
 <code>ByteString</code>:</p><pre>import Data.Text (unpack, append)
import qualified Data.ByteString.Base64.Lazy as B64

main :: IO ()
main = withUrl &quot;ws://my-server.com&quot; $ \conn -&gt;
    forever $ do
        msg &lt;- receiveMessage
        putStrLn $ case msg of
            SocketMsgText t -&gt;
                unpack $ append &quot;Received text: &quot; t
            SocketMsgData d -&gt;
                &quot;Received data: &quot; ++ show (B64.encode d)</pre><p>You can talk to multiple connections by nesting <code><a href="JavaScript-WebSockets.html#v:withUrl">withUrl</a></code>:</p><pre>-- Act as a relay between two servers
main :: IO ()
main =  withUrl &quot;ws://server-1.com&quot; $ \conn1 -&gt;
        withUrl &quot;ws://server-2.com&quot; $ \conn2 -&gt;
            forever $ do
                msg &lt;- receiveMessage conn1
                sendMessage conn2 msg</pre><p>And also alternatively, you can manually open and close connections:</p><pre>-- Act as a relay between two servers
main :: IO ()
main = do
    conn1 &lt;- openConnection &quot;ws://server-1.com&quot;
    conn2 &lt;- openConnection &quot;ws://server-2.com&quot;
    forever $ do
        msg &lt;- receiveMessage conn1
        sendMessage conn2 msg
    closeConnection conn2
    closeConnection conn1</pre><p><code><a href="JavaScript-WebSockets.html#v:receiveMessage">receiveMessage</a></code> and its varieties will all throw an exception if the
 connection closes while they're waiting or if you attempt to receive on
 a closed connection.  You can handle these with mechanisms from
 <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Control-Exception.html">Control.Exception</a>, or you can use their &quot;maybe&quot;-family counterparts,
 <code><a href="JavaScript-WebSockets.html#v:receiveMessageMaybe">receiveMessageMaybe</a></code>, etc., who will return results in <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#v:Just">Just</a></code> on
 a success, or return a <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#v:Nothing">Nothing</a></code> if the connection is closed or if
 receiving on a closed connection.</p><p>You can use also <code><code><a href="JavaScript-WebSockets.html#v:connectionClosed">connectionClosed</a></code> :: <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> -&gt; <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a></code> <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></code></code> to
 check if the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> object is closed (or
 <code><a href="JavaScript-WebSockets.html#v:connectionCloseReason">connectionCloseReason</a></code> to see *why*).</p><p>When closing connections, there might be some messages that were
 received by the socket but never processed on the Haskell side with
 a <code><a href="JavaScript-WebSockets.html#v:receive">receive</a></code> method.  These will normally be deleted; however, you can
 use <code><a href="JavaScript-WebSockets.html#v:closeConnectionLeftovers">closeConnectionLeftovers</a></code> or <code><a href="JavaScript-WebSockets.html#v:withUrlLeftovers">withUrlLeftovers</a></code> to grab a list of
 the raw <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code>s remaining after closing.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Connection" class="def">Connection</a></p><div class="doc"><p>Encapsulates a (reference to a) Javascript Websocket connection.  Can
 be created/accessed with either <code>openConnection</code> or (preferably)
 <code>withUrl</code>.</p><p>Care must be taken to close the connection once you are done if using
 <code>openConnection</code>, or unprocessed messages and callbacks will continue to
 queue up.</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a name="t:WSSendable" class="def">WSSendable</a> s</p><div class="doc"><p>A typeclass offering a gratuitous abstraction over what can be sent
 through a <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.  Allows you to wrap things in a <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code>
 automatically.  The only instances that should really ever exist are
 <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> and instances of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>.</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="JavaScript-WebSockets-Internal.html#v:wrapSendable">wrapSendable</a></p></div><div class="subs instances"><p id="control.i:WSSendable" class="caption collapser" onclick="toggleSection('i:WSSendable')">Instances</p><div id="section.i:WSSendable" class="show"><table><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:WSSendable">WSSendable</a> a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="JavaScript-WebSockets.html#t:WSSendable">WSSendable</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a name="t:WSReceivable" class="def">WSReceivable</a> s</p><div class="doc"><p>A typeclass offering a gratuitous abstraction over what can be
 received through a <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.  Allows you to unwrap things in
 a <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code> automatically.  The only instances that should really ever
 exist are <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> and instances of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>.</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="JavaScript-WebSockets-Internal.html#v:unwrapReceivable">unwrapReceivable</a></p></div><div class="subs instances"><p id="control.i:WSReceivable" class="caption collapser" onclick="toggleSection('i:WSReceivable')">Instances</p><div id="section.i:WSReceivable" class="show"><table><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:SocketMsg" class="def">SocketMsg</a></p><div class="doc"><p>Sum type over the data that can be sent or received through
 a JavaScript websocket.</p><p>What an incoming message is classified as depends on the Javascript
 Websockets API <a href="http://www.w3.org/TR/websockets/">http://www.w3.org/TR/websockets/</a>, which provides
 a &quot;typed&quot; input channel of either text or binary blob.</p><p>There are several convenience functions to help you never have to deal
 with this explicitly; its main purpose is if you want to explicitly
 branch on a <code>receiveMessage</code> depending on what kind of message you
 receive and do separate things. <code>receiveText</code> and <code>receiveData</code> will
 both allow you to &quot;filter&quot; incoming messages by their type.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:SocketMsgText" class="def">SocketMsgText</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:SocketMsgData" class="def">SocketMsgData</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/bytestring-0.10.6.0/html/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:SocketMsg" class="caption collapser" onclick="toggleSection('i:SocketMsg')">Instances</p><div id="section.i:SocketMsg" class="show"><table><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Eq.html#t:Eq">Eq</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Text-Show.html#t:Show">Show</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Typeable-Internal.html#t:Typeable">Typeable</a> * <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ConnClosing" class="def">ConnClosing</a></p><div class="doc"><p>Data type containing information on <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes.</p><ul><li><code><a href="JavaScript-WebSockets.html#v:ManualClose">ManualClose</a></code>: Closed by the Haskell <code><a href="JavaScript.html#t:WebSockets">WebSockets</a></code>
    interface, using <code><a href="JavaScript-WebSockets.html#v:closeConnection">closeConnection</a></code> or variants.</li><li><p><code><a href="JavaScript-WebSockets.html#v:JSClose">JSClose</a></code>: Closed on the Javascript end, either by a connection error
    or server request, or what have you.  Contains information from the
    Javascript Websockets API
    <a href="http://www.w3.org/TR/websockets/#event-definitions">http://www.w3.org/TR/websockets/#event-definitions</a>.</p><p>The first field is whether or not it was a clean close; the second
field is the closing reason code; the third field is a <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> with
the reason given by the Websockets API.</p></li><li><code>OpenInterupptedClose</code>: There was an unexpected error encountered
    when attempting to open the connection.</li><li><code><a href="JavaScript-WebSockets.html#v:UnexpectedClose">UnexpectedClose</a></code>: Otherwise uncategorized closed status, with
    a <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> field offering a reason.</li></ul></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ManualClose" class="def">ManualClose</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:JSClose" class="def">JSClose</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a>) (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Int.html#t:Int">Int</a>) (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OpenInterruptedClose" class="def">OpenInterruptedClose</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:UnexpectedClose" class="def">UnexpectedClose</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:ConnClosing" class="caption collapser" onclick="toggleSection('i:ConnClosing')">Instances</p><div id="section.i:ConnClosing" class="show"><table><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Eq.html#t:Eq">Eq</a> <a href="JavaScript-WebSockets.html#t:ConnClosing">ConnClosing</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Text-Show.html#t:Show">Show</a> <a href="JavaScript-WebSockets.html#t:ConnClosing">ConnClosing</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ConnectionException" class="def">ConnectionException</a></p><div class="doc"><p>An exception that may be thrown when using the various <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>
 operations.  Right now, only includes <code><a href="JavaScript-WebSockets.html#v:ConnectionClosed">ConnectionClosed</a></code>, which is
 thrown when using an &quot;unsafe&quot; <code>receive</code> on a closed <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>, or if
 a <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes while an unsafe <code>receive</code> is waiting.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ConnectionClosed" class="def">ConnectionClosed</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:_socketOrigin" class="def">_socketOrigin</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:ConnectionException" class="caption collapser" onclick="toggleSection('i:ConnectionException')">Instances</p><div id="section.i:ConnectionException" class="show"><table><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Eq.html#t:Eq">Eq</a> <a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Text-Show.html#t:Show">Show</a> <a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Control-Exception-Base.html#t:Exception">Exception</a> <a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Typeable-Internal.html#t:Typeable">Typeable</a> * <a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:2">Opening, closing, and working with connections</h1><div class="top"><p class="src"><a name="v:withUrl" class="def">withUrl</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></td><td class="doc"><p>Websocket address to connect to</p></td></tr><tr><td class="src">-&gt; (<a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a)</td><td class="doc"><p>Process to run on connection</p></td></tr><tr><td class="src">-&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Performs the given <code>Connection -&gt; IO a</code> process attached to the given
 server url.  Handles opening and closing the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> for you (and
 clearing the message queue afterwards), and cleans up on errors.</p><p>If any messages were received by the socket but never processed/received
 on the Haskell end, this will delete and drop them.  Use
 <code><a href="JavaScript-WebSockets.html#v:withUrlLeftovers">withUrlLeftovers</a></code> to get a hold of them.</p></div></div><div class="top"><p class="src"><a name="v:withUrlLeftovers" class="def">withUrlLeftovers</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></td><td class="doc"><p>Websocket address to connect to</p></td></tr><tr><td class="src">-&gt; (<a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a)</td><td class="doc"><p>Process to run on connection</p></td></tr><tr><td class="src">-&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (a, [<a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a>])</td><td class="doc"><p>Result of process, with leftovers</p></td></tr></table></div><div class="doc"><p>Like <code><a href="JavaScript-WebSockets.html#v:withUrl">withUrl</a></code>, except returns also the &quot;leftover messages&quot; that were
 received by the socket but never processed on the Haskell end with
 <code><a href="JavaScript-WebSockets.html#v:receive">receive</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:openConnection" class="def">openConnection</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="JavaScript-WebSockets.html#t:Connection">Connection</a></p><div class="doc"><p>Opens a websocket connection to the given url, and returns the
 <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> after connection is completed and opened.  Care should be
 taken to ensure that the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> is later closed with
 <code><a href="JavaScript-WebSockets.html#v:closeConnection">closeConnection</a></code>.</p><p>Consider using <code><a href="JavaScript-WebSockets.html#v:withUrl">withUrl</a></code>, which handles closing with bracketing and
 error handling so you don't have to worry about closing the connection
 yourself.</p><p>Blocks until the connection has been established and opened.</p><p>If an async exception happens while this is waiting, the socket will be
 closed as the exception bubbles up.</p></div></div><div class="top"><p class="src"><a name="v:closeConnection" class="def">closeConnection</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Manually closes the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.  Will un-block all threads
 currently waiting on the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> for messages (releasing their
 callbacks) and disable sending and receiving in the future.</p><p>All leftover messages that were never processed on the Haskell end will
 be deleted; use <code><a href="JavaScript-WebSockets.html#v:dumpConnectionQueue">dumpConnectionQueue</a></code> to manually fetch them before
 closing, or <code><a href="JavaScript-WebSockets.html#v:closeConnectionLeftovers">closeConnectionLeftovers</a></code> to recover them while closing.</p></div></div><div class="top"><p class="src"><a name="v:closeConnectionLeftovers" class="def">closeConnectionLeftovers</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> [<a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a>]</p><div class="doc"><p>Manually closes the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.  It un-blocks all threads
 currently waiting on the connection and disables all sending and
 receiving in the future.</p><p>The result is a list of all messages received by the connection but not
 yet retrieved by <code>receive</code>, etc. on the Haskell end.</p><p>To close and ignore leftovers, use <code><a href="JavaScript-WebSockets.html#v:closeConnection">closeConnection</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:clearConnectionQueue" class="def">clearConnectionQueue</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Clears the message queue (messages waiting to be <code>receive</code>d) on the
 given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.  Is essentially a no-op on closed connections.</p></div></div><div class="top"><p class="src"><a name="v:dumpConnectionQueue" class="def">dumpConnectionQueue</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> [<a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a>]</p><div class="doc"><p>Returns all incoming messages received by the socket and queued for
 retrieval using <code>receive</code> functions.  Empties the queue.</p></div></div><div class="top"><p class="src"><a name="v:connectionClosed" class="def">connectionClosed</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Check if the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> is closed.  Returns a <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></code>.  To
 check *why* it was closed, see <code><a href="JavaScript-WebSockets.html#v:connectionCloseReason">connectionCloseReason</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:connectionCloseReason" class="def">connectionCloseReason</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="JavaScript-WebSockets.html#t:ConnClosing">ConnClosing</a>)</p><div class="doc"><p>Returns <code>Nothing</code> if the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> is still open, or <code>Just
 closing</code> containing a <code><a href="JavaScript-WebSockets.html#t:ConnClosing">ConnClosing</a></code> with information on why the
 connection was closed.</p><p>For just a <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></code> saying whether or not the connection is closed, try
 <code><a href="JavaScript-WebSockets.html#v:connectionClosed">connectionClosed</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:connectionOrigin" class="def">connectionOrigin</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></p><div class="doc"><p>Returns the origin url of the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.</p></div></div><h1 id="g:3">Sending data</h1><div class="top"><p class="src"><a name="v:sendData" class="def">sendData</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; a -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Send the given serializable (instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>) data on the given
 connection.</p><p>Returns <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#v:True">True</a></code> if the connection is open, and <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#v:False">False</a></code> if it is closed.
 In the future will return more feedback about whether or not the send
 was completed succesfully.</p></div></div><div class="top"><p class="src"><a name="v:sendData_" class="def">sendData_</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; a -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Send the given serializable (instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>) data on the given
 connection.</p><p>Fails silently if the connection is closed or otherwise was not
 succesful.  Use <code><a href="JavaScript-WebSockets.html#v:sendData">sendData</a></code> to get feedback on the result of the send.</p></div></div><div class="top"><p class="src"><a name="v:sendText" class="def">sendText</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Send the given (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> on the given connection.</p><p>Returns <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#v:True">True</a></code> if the connection is open, and <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#v:False">False</a></code> if it is closed.
 In the future will return more feedback about whether or not the send
 was completed succesfully.</p></div></div><div class="top"><p class="src"><a name="v:sendText_" class="def">sendText_</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Send the given (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> on the given connection.</p><p>Fails silently if the connection is closed or otherwise was not
 succesful.  Use <code><a href="JavaScript-WebSockets.html#v:sendText">sendText</a></code> to get feedback on the result of the send.</p></div></div><div class="top"><p class="src"><a name="v:sendMessage" class="def">sendMessage</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Sends the given <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code> through the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.
 A <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code> is a sum type of either 'SocketMsgText t', containing
 (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code>, or 'SocketMsgData d', containing a (lazy) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/bytestring-0.10.6.0/html/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></code>.</p><p>Returns <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#v:True">True</a></code> if the connection is open, and <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#v:False">False</a></code> if it is closed.
 In the future will return more feedback about whether or not the send
 was completed succesfully.</p></div></div><div class="top"><p class="src"><a name="v:sendMessage_" class="def">sendMessage_</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Sends the given <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code> through the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.
 A <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code> is a sum type of either 'SocketMsgText t', containing
 (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code>, or 'SocketMsgData d', containing a (lazy) <code>ByteString</code>.</p><p>Fails silently if the connection is closed or otherwise was not
 succesful.  Use <code><a href="JavaScript-WebSockets.html#v:sendMessage">sendMessage</a></code> to get feedback on the result of the send.</p></div></div><div class="top"><p class="src"><a name="v:send" class="def">send</a> :: <a href="JavaScript-WebSockets.html#t:WSSendable">WSSendable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; a -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Send the given item through the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.</p><p>You can <code><a href="JavaScript-WebSockets.html#v:send">send</a></code> either (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> or any instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>,
 due to over-indulgent typeclass magic; this is basically a function that
 works everywhere you would use <code><a href="JavaScript-WebSockets.html#v:sendText">sendText</a></code> or <code><a href="JavaScript-WebSockets.html#v:sendData">sendData</a></code>.</p><p>Returns <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#v:True">True</a></code> if the connection is open, and <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Bool.html#v:False">False</a></code> if it is closed.
 In the future will return more feedback about whether or not the send
 was completed succesfully.</p></div></div><div class="top"><p class="src"><a name="v:send_" class="def">send_</a> :: <a href="JavaScript-WebSockets.html#t:WSSendable">WSSendable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; a -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Send the given item through the given <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>.</p><p>You can <code><a href="JavaScript-WebSockets.html#v:send_">send_</a></code> either (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> or any instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>,
 due to over-indulgent typeclass magic; this is basically a function that
 works everywhere you would use <code><a href="JavaScript-WebSockets.html#v:sendText_">sendText_</a></code> or <code><a href="JavaScript-WebSockets.html#v:sendData_">sendData_</a></code>.</p><p>Fails silently if the connection is closed or otherwise was not
 succesful.  Use <code><a href="JavaScript-WebSockets.html#v:send">send</a></code> to get feedback on the result of the send.</p></div></div><h1 id="g:4">Receiving data</h1><div class="top"><p class="src"><a name="v:receive" class="def">receive</a> :: <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a</p><div class="doc"><p>Block and wait until either something decodable as the desired type is
 received (returning it), or the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes (throwing
 a <code><a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></code>).  Throws the exception immediately if the
 <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> is already closed and there are no queued messages left.</p><p>This is polymorphic on its return type, so remember to let the type
 inference system know what you want at some point or just give an
 explicit type signature --- <code>receiveData conn :: IO (Maybe Int)</code>, for
 example.</p><p>All non-decodable or non-matching data that comes along is discarded.</p><p>You can <code><a href="JavaScript-WebSockets.html#v:receive">receive</a></code> either (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> or any instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>,
 due to over-indulgent typeclass magic; this is basically a function that
 works everywhere you would use <code><a href="JavaScript-WebSockets.html#v:receiveText">receiveText</a></code> or <code><a href="JavaScript-WebSockets.html#v:receiveData">receiveData</a></code>.</p><p>To handle closed sockets with <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a></code>, use <code><a href="JavaScript-WebSockets.html#v:receiveMaybe">receiveMaybe</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:receiveMaybe" class="def">receiveMaybe</a> :: <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> a)</p><div class="doc"><p>Block and wait until either something decodable as the desired type is
 received (returning <code>Just x</code>), or the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes (returning
 <code>Nothing</code>).  Returns <code>Nothing</code> immediately if the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> is
 already closed and there are no queued messages left.</p><p>This is polymorphic on its return type, so remember to let the type
 inference system know what you want at some point or just give an
 explicit type signature --- <code>receiveData conn :: IO (Maybe Int)</code>, for
 example.</p><p>All non-decodable or non-matching data that comes along is discarded.</p><p>You can <code><a href="JavaScript-WebSockets.html#v:receive">receive</a></code> either (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> or any instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>,
 due to over-indulgent typeclass magic; this is basically a function that
 works everywhere you would use <code><a href="JavaScript-WebSockets.html#v:receiveText">receiveText</a></code> or <code><a href="JavaScript-WebSockets.html#v:receiveData">receiveData</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:receiveText" class="def">receiveText</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></p><div class="doc"><p>Block and wait until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives a &quot;typed&quot; <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code>.  This
 is determined by Javascript's own &quot;typed&quot; Websockets API
 <a href="http://www.w3.org/TR/websockets/">http://www.w3.org/TR/websockets/</a>, which receives data
 typed either as text or as a binary blob.  Returns the first encountered
 text.  Throws a <code><a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></code> if the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes first,
 and throws one immediately if the connection is already closed and there
 are no queued messages left.</p><p>All &quot;binary blobs&quot; encountered are discarded.</p><p>To handle closed sockets with <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a></code>, use <code><a href="JavaScript-WebSockets.html#v:receiveTextMaybe">receiveTextMaybe</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:receiveTextMaybe" class="def">receiveTextMaybe</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a>)</p><div class="doc"><p>Block and wait until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives a &quot;typed&quot; <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code>.  This
 is determined by Javascript's own &quot;typed&quot; Websockets API
 <a href="http://www.w3.org/TR/websockets/">http://www.w3.org/TR/websockets/</a>, which receives data typed either as
 text or as a binary blob.  Returns <code>Just t</code> on the first encountered
 text.  Returns <code>Nothing</code> if the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes while it is waiting,
 or immediately if the connection is already closed and there are no
 queued messages left.</p><p>All &quot;binary blobs&quot; encountered are discarded.</p></div></div><div class="top"><p class="src"><a name="v:receiveData" class="def">receiveData</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> a</p><div class="doc"><p>Block and wait until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives a &quot;binary blob&quot;
 decodable as the desired instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>.  Returns the first
 succesfully decoded data, and throws a <code><a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></code> if the
 <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes first.  Throws the exception immediately if the
 <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> is already closed and there are no queued messages left.</p><p>This is polymorphic on its return type, so remember to let the type
 inference system know what you want at some point or just give an
 explicit type signature --- <code>receiveData conn :: IO (Maybe Int)</code>, for
 example.</p><p>All incoming messages received that cannot be decoded as the data type
 (or are text) will be discarded.</p><p>To handle closed sockets with <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a></code>, use <code><a href="JavaScript-WebSockets.html#v:receiveDataMaybe">receiveDataMaybe</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:receiveDataMaybe" class="def">receiveDataMaybe</a> :: <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> a)</p><div class="doc"><p>Block and wait until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives a &quot;binary blob&quot;
 decodable as the desired instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code>.  Returns <code>Just x</code> as soon
 as it is able to decode a blob, and <code>Nothing</code> if the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes
 while it is waiting.  Returns <code>Nothing</code> immediately if the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code>
 is already closed and there are no queued messages left.</p><p>All incoming messages received that cannot be decoded as the data type
 (or are text) will be discarded.</p><p>This is polymorphic on its return type, so remember to let the type
 inference system know what you want at some point or just give an
 explicit type signature --- <code>receiveData conn :: IO (Maybe Int)</code>, for
 example.</p></div></div><div class="top"><p class="src"><a name="v:receiveMessage" class="def">receiveMessage</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></p><div class="doc"><p>Block and wait until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives any message, and
 returns the message wrapped in a <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code>.  A <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code> is a sum
 type of either 'SocketMsgText t', containing (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code>, or
 'SocketMsgData d', containing a (lazy) <code>ByteString</code>.</p><p>Will return the message as soon as any is received, or throw
 a <code><a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></code> if the connection is closed while waiting.
 Throws an exception immediately if the connection is already closed.</p><p>To handle closed sockets with <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a></code>, use <code><a href="JavaScript-WebSockets.html#v:receiveMessageMaybe">receiveMessageMaybe</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:receiveMessageMaybe" class="def">receiveMessageMaybe</a> :: <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a>)</p><div class="doc"><p>Block and wait until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives any message, and
 returns the message wrapped in a <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code>.  A <code><a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a></code> is a sum
 type of either 'SocketMsgText t', containing (strict) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code>, or
 'SocketMsgData d', containing a (lazy) <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/bytestring-0.10.6.0/html/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></code>.</p><p>Will return 'Just msg' as soon as any message is received, or <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#v:Nothing">Nothing</a></code>
 if the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes first.  Returns <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#v:Nothing">Nothing</a></code> immediately if the
 <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> is already closed.</p></div></div><div class="top"><p class="src"><a name="v:receiveEither" class="def">receiveEither</a> :: <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Either.html#t:Either">Either</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a> a)</p><div class="doc"><p>Block and wait until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives any message, and
 attempts to decode it depending on the desired type.  If <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> is
 requested, assumes Utf8-encoded text or just a plain Javascript string.
 If an instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code> is requested, attempts to decode it into that
 instance.  Successful parses return 'Right x', and failed parses return
 'Left SocketMsg' (A sum type between <code><a href="JavaScript-WebSockets.html#v:SocketMsgText">SocketMsgText</a></code> containing (strict)
 <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> and <code><a href="JavaScript-WebSockets.html#v:SocketMsgData">SocketMsgData</a></code> containing a (lazy) <code>ByteString</code>).  Nothing
 is ever discarded.</p><p>Will return the message as soon as any is received, or throw
 a <code><a href="JavaScript-WebSockets.html#t:ConnectionException">ConnectionException</a></code> if the connection is closed while waiting.
 Throws an exception immediately if the connection is already closed and
 there are no queued messages left.</p><p>To handle closed sockets with <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a></code>, use <code><a href="JavaScript-WebSockets.html#v:receiveEitherMaybe">receiveEitherMaybe</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:receiveEitherMaybe" class="def">receiveEitherMaybe</a> :: <a href="JavaScript-WebSockets.html#t:WSReceivable">WSReceivable</a> a =&gt; <a href="JavaScript-WebSockets.html#t:Connection">Connection</a> -&gt; <a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/System-IO.html#t:IO">IO</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/base-4.7.0.2/html/Data-Either.html#t:Either">Either</a> <a href="JavaScript-WebSockets.html#t:SocketMsg">SocketMsg</a> a))</p><div class="doc"><p>Block and wait until the <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> receives any message, and
 attempts to decode it depending on the desired type.  If <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> is
 requested, assumes Utf8-encoded text or just a plain Javascript string.
 If an instance of <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/binary-0.7.2.3/html/Data-Binary.html#t:Binary">Binary</a></code> is requested, attempts to decode it into that
 instance.  Successful parses return 'Right x', and failed parses return
 'Left SocketMsg' (A sum type between <code><a href="JavaScript-WebSockets.html#v:SocketMsgText">SocketMsgText</a></code> containing (strict)
 <code><a href="file:///home/justin/.ghcjs/x86_64-linux-0.1.0-7.8.3/ghcjs/doc/lib/text-1.2.0.3/html/Data-Text.html#t:Text">Text</a></code> and <code><a href="JavaScript-WebSockets.html#v:SocketMsgData">SocketMsgData</a></code> containing a (lazy) <code>ByteString</code>).  Nothing
 is ever discarded.</p><p>Returns <code>Just result</code> on the first message received, or <code>Nothing</code> if the
 <code><a href="JavaScript-WebSockets.html#t:Connection">Connection</a></code> closes while waiting.  Returns <code>Nothing</code> if the connection
 is already closed and there are no queued messages left.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.15.0.2</p></div></body></html>